/*! canvas-toy 2016-02-15 */
function initWebGL(a){var b=null;try{b=a.getContext("experimental-webgl")}catch(c){b=a.getContext("webgl")}return b||alert("can't init webgl, current browser may not support it."),b}function compileShader(a,b){var c=document.getElementById(b);if(!c)return null;for(var d="",e=c.firstChild;e;)3==e.nodeType&&(d+=e.textContent),e=e.nextSibling;var f;if("x-shader/x-fragment"==c.type)f=a.createShader(a.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!=c.type)return alert(b+": unknown shader type"),null;f=a.createShader(a.VERTEX_SHADER)}return a.shaderSource(f,d),a.compileShader(f),a.getShaderParameter(f,a.COMPILE_STATUS)?f:(alert("An error occurred compiling the shaders: "+a.getShaderInfoLog(f)),null)}function getShaderProgram(a,b,c){return shaderProgram=a.createProgram(),a.attachShader(shaderProgram,b),a.attachShader(shaderProgram,c),a.linkProgram(shaderProgram),shaderProgram}function setProgram(a,b,c,d){}var CanvasToy={};CanvasToy.Camera=function(){this.projectionMatrix=mat4.create()},CanvasToy.Camera.prototype=Object3d.create(Object3d.prototype),CanvasToy.Camera.prototype.constructor=Camera,CanvasToy.Camera.prototype.lookAt=function(a,b,c){this.projectionMatrix.lookAt(a,b,c)},CanvasToy.Mesh=function(a,b){this.geometry=a||new Geometry,this.material=b||new Material},CanvasToy.Mesh.prototype=Object.create(CanvasToy.RenderNode.prototype),CanvasToy.Mesh.prototype.constructor=CanvasToy.RenderNode,CanvasToy.Mesh.prototype.draw=function(a,b){RenderNode.draw.call(this),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.geometry.vertices),this.webglContext.STATIC_DRAW),a.drawArrays(a.TRIANGLE_STRIP,0,this.geometry.vertices.length)},CanvasToy.Renderer=function(a){this.canvasDom=a||document.createElement("canvas"),this.programs=[],this.webglContext=initWebwebglContext(a),this.initMatrix();compileShader(this.webglContext,"shader-vs"),compileShader(this.webglContext,"shader-fs");this.webglContext.clearColor(0,0,0,1),this.webglContext.clearDepth(1),this.webglContext.enable(this.webglContext.DEPTH_TEST),this.webglContext.depthFunc(this.webglContext.LEQUAL)},CanvasToy.Renderer.prototype.render=function(a,b){this.webglContext.clear(this.webglContext.COLOR_BUFFER_BIT|this.webglContext.DEPTH_BUFFER_BIT),a.renderObjects.forEach(function(a){a.draw(b)})},CanvasToy.Renderer.prototype.initMatrix=function(){glMatrix.setMatrixArrayType(Float32Array)},CanvasToy.Scene=function(){this.renderObjects=[]},CanvasToy.Scene.prototype=Object.create(RenderNode),CanvasToy.Scene.prototype.constructor=RenderNode,CanvasToy.Scene.prototype.draw=function(a){CanvasToy.RenderNode.draw.call(this,a)},CanvasToy.Scene.prototype.addChild=function(a){CanvasToy.RenderNode.addChild.call(this,a),this.renderObjects.push(a)},CanvasToy.CubeGeometry=function(){Geometry.call(this),this.vertices=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],this.initBuffers()},CanvasToy.CubeGeometry.prototype=Object.create(CanvasToy.Geometry.prototype),CanvasToy.CubeGeometry.prototype.constructor=CanvasToy.CubeGeometry,CanvasToy.Geometry=function(a){CanvasToy.RenderNode.call(this),this.vertices=[]},CanvasToy.Geometry.prototype.initBuffers=function(){this.vertBuffer=this.webglContext.createBuffer(),this.webglContext.bindBuffer(this.webglContext.ARRAY_BUFFER,this.vertBuffer)},CanvasToy.Material=function(a){},CanvasToy.Object3d=function(){this.webglContext=options.webglContext,this.modelViewMatrix=mat4.create(),this.matrix=mat4.create(),this.position=vec3.create(),this.scale=vec3.create()},CanvasToy.Object3d.prototype.start=function(){},CanvasToy.Object3d.prototype.update=function(a){},CanvasToy.Object3d.updateMatrices=function(){},CanvasToy.Object3d.prototype.tranlate=function(a,b,c){this.modelViewMatrix=mat4.tranlate(mat4.create(),this.modelViewMatrix,new vec3(a,b,c))},CanvasToy.Object3d.prototype.tranlateTo=function(a,b,c){},CanvasToy.Object3d.prototype.scale=function(a,b,c){this.modelViewMatrix=mat4.scale(mat4.create(),this.modelViewMatrix,new vec3(a,b,c))},CanvasToy.Object3d.prototype.rotate=function(a,b){this.modelViewMatrix=mat4.rotate(mat4.create(),this.modelViewMatrix,new vec3(deltaX,deltaY,deltaZ))},CanvasToy.Object3d.prototype.rotate=function(){},CanvasToy.RenderNode=function(){Object3d.call(this),this.relativeMatrix=mat4.create(),this.children=[],this.parent=null},CanvasToy.RenderNode.prototype=Object.create(CanvasToy.Object3d.prototype),CanvasToy.RenderNode.prototype.constructor=CanvasToy.Object3d,CanvasToy.RenderNode.prototype.addChild=function(a){this.children.push(a),a.parent=this},CanvasToy.RenderNode.prototype.updateMatrices=function(){var a=this.parent.matrix;this.modelViewMatrix=mat4.mul(mat4.create(),this.relativeMatrix,a),this.children.forEach(function(a){this.children[a].updateMatrices()})},CanvasToy.RenderNode.prototype.draw=function(a){this.matrix=mat4.mul(mat4.create(),a.projectionMatrix,this.modelViewMatrix)};